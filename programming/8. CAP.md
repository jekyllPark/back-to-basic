# CAP?
CAP 이론은 일관성, 가용성, 분할 허용성에 관한 것으로,

시스템 장애로 인해 몇 인스턴스가 다른 인스턴스와 통신할 수 없을 때 전체 데이터베이스를 어떻게 제어할 지 결정하는 것에 관한 것입니다.

즉, CAP 이론은 분산 데이터베이스 시스템은 분할이 생겼을 때 일관성과 가용성 중 하나를 희생해야 한다는 것을 의미합니다.

분산 데이터베이스 시스템은 반드시 네트워크 장애나 여러 이유들로 인해 장애가 발생할 수 밖에 없는데, 그러므로 분산 데이터베이스 시스템은 반드시 분할 허용성을 가지고 있어야 하며, 일관성과 가용성 중 하나를 선택해야 합니다.

예를 들어 두 노드로 이루어진 분산 시스템에서 분할이 생겼을 때 데이터의 일관성을 보장하기란 불가능합니다.

그러므로 분할이 생겼더라도 정상적으로 요청을 처리해 일관성을 희생하고 가용성을 높이든,

잠시 요청 처리를 중단하고 중단된 노드가 재실행될 때까지 기다려 가용성을 희생하고 일관성을 지키는 방법 중 하나를 선택해야 합니다.

일관성이란 사용자가 분산 데이터베이스 상의 어떤 노드와 통신을 하는지 여부와 상관없이 같은 데이터를 조회할 수 있는 것을 의미합니다.

일관성의 목표는 데이터의 동기화가 충분히 빨라 사용 상의 문제가 없게끔 하는 것입니다.

가용성이란 모든 요청이 응답을 받을 수 있어야 한다는 것을 의미합니다.

즉, 시스템이 중단되는 일 없이 안제든 사용 가능한 상태여야 합니다.

사용자가 데이터가 일관되지 않더라도 언제든지 접근할 수 있다는 것을 의미합니다.

분할 허용성이란, 한 노드가 다른 노드와 통신 할 수 없을 때 분할이 생겼다고 합니다.

분할 허용성은 시스템 내 분할이 생기더라도 시스템이 여전히 작동하는 것을 의미합니다.

## CP 시스템

완벽한 일관성을 갖는 분산 시스템에서 데이터 변경은 존재하는 모든 노드에 복제되어야 완료됩니다.

이는 가용성과 성능에 크나 큰 악영향을 끼칩니다.

만약 하나의 노드라도 문제가 있으면 트랜잭션은 실패합니다.

그리고 노드가 늘어날 수록 지연시간은 길어집니다.

## AP 시스템

완벽한 가용성을 갖는 분산 시스템에서 모든 노드가 어떠한 상황에서도 응답할 수 있어야 합니다.

네트워크 문제가 발생해서 어떤 노드에 레플리케이션이 제대로 이뤄지지 않아도 가용성을 위해서 해당 노드에 접근한 사용자에게 데이터를 반환한다고 가정하면, 일관성은 물론 사용자는 문제가 발생한 것을 인지도 못할 것입니다.

## CA 시스템

일관성과 가용성을 동시에 만족하려면 네트워크 장애를 허용하지 않아야 합니다.

네트워크 장애가 절대 일어나지 않는 네트워크 구성이 가능할까? 하면 존재하지 않습니다.

결국 CAP 이론은 네트워크 파티션 허용은 기본적으로 깔고 시작해야 합니다. 무조건 P를 선택하고 C와 A 중 하나를 골라야 합니다.

## PACELC 이론

PACELC 이론은 CAP 이론으로 부족한 부분을 보완하기 위해 네트워크 장애 상황과 정상 상황으로 나누어 설명하는 이론입니다.

**P(네트워크 파티션)상황에서 A(가용성)과 C(일관성)의 상충 관계와 E(else, 정상)상황에서 L(지연 시간)과 C(일관성)의 상충 관계를 설명한다.**

![image](https://github.com/jekyllPark/back-to-basic/assets/114489012/7caffb1e-ee59-434e-9dac-49c5bf03ff26)

PACELC 이론에서는 장애, 정상 상황에 어떻게 동작하는지에 따라 시스템을 PC/EC, PC/EL, PA/EC, PA/EL로 나눌 수 있습니다.

MySQL을 예시로 마스터 슬레이브로 구성된 MySQL 서버는 기본적으로 PA/EL 입니다.

# CAP 이론으로 분류한 DB
![image](https://github.com/jekyllPark/back-to-basic/assets/114489012/d36208f0-2872-4e82-8cf4-49eb514b69d6)

> https://datafibers-community.github.io/blog/2018/06/17/2018-06-17-nosql-overview/

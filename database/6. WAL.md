# WAL
### **동작 원리:**
1. **트랜잭션 시작:** 새로운 트랜잭션이 시작되면, 해당 트랜잭션에 대한 변경 사항이 데이터 파일에 바로 기록되지 않습니다.
2. **메모리에서의 변경:** 트랜잭션 수행 중에 이루어진 데이터베이스의 변경은 먼저 메모리에 기록됩니다. 이는 빠르게 이루어집니다.
3. **WAL 로그 기록:** 메모리에 기록된 변경 사항은 동시에 WAL 로그에 기록됩니다. 이 로그는 디스크에 순차적으로 쓰여지는데, 이를 'Write-Ahead Logging'이라고 합니다.
4. **트랜잭션 커밋:** 트랜잭션이 성공적으로 완료되면, 해당 트랜잭션을 커밋합니다.
5. **디스크에 변경사항 반영:** WAL 로그를 사용하여 변경 사항이 디스크에 기록됩니다. 디스크에는 실제 데이터 파일이 아니라 WAL 로그만 순차적으로 기록됩니다.
6. **디스크에 데이터 반영:** WAL 로그에 대한 기록이 디스크에 안정적으로 기록되면, 해당 변경 사항이 데이터 파일에 적용됩니다.
### **왜 필요한가?**

1. **내구성 보장:** WAL은 데이터베이스의 내구성을 보장합니다. 트랜잭션이 커밋되면, 해당 트랜잭션의 변경 사항이 디스크에 안전하게 기록되기 때문에 시스템 장애가 발생하더라도 데이터를 복구할 수 있습니다.
2. **성능 향상:** 변경 사항을 메모리에 먼저 기록하고 WAL 로그를 사용하여 디스크에 비동기적으로 기록함으로써, 데이터베이스의 성능을 향상시킬 수 있습니다. 디스크에 순차적으로 기록되기 때문에 랜덤 I/O를 최소화할 수 있습니다.
3. **복구 기능:** WAL은 데이터베이스의 복구 기능을 지원합니다. 시스템이 예기치 않게 중단되면, WAL을 사용하여 마지막으로 성공적으로 완료된 트랜잭션까지의 변경 사항을 재적용하여 데이터베이스를 복구할 수 있습니다.
